<%inherit file="page_structure.html"/>

<%block name="title">
    <title>Профиль объекта</title>
    <link href="/static/css/dashboard.css" rel="stylesheet">
    <script src="/static/ckeditor/ckeditor.js"></script>
</%block>

    <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
        <h2 class="sub-header">${obj.NAME}</h2>
        % if obj.__tablename__ == 'dynamic_object':
            <p>Кейсы:
                % for i in nbrs:
                    % if i[1] < 1.2:
                        <a href="/object/${cases[i[0]].uuid}">
                            <span class="label label-warning">
                                ${cases[i[0]].subject}
                            </span>
                        </a>
                    % endif
                % endfor
            </p>
        % endif
        <div class="table-responsive">
            <table class="table table-striped">
              <tbody>
                % if obj.__dict__['uuid'] in neighbors or 'admin' in session_context['groups']:
                    %if obj.__tablename__ == 'cases':
                        % for key in view_f:
                            % if key == 'query':
                                <tr>
                                 <td> ${all_f[key]}</td>
                                 <td>
                                     <textarea disabled name="${key}">
                                         ${obj.__dict__[key]}
                                     </textarea>
                                     <script>
                                     // Replace the <textarea id="editor1"> with a CKEditor
                                     // instance, using default configuration.
                                     CKEDITOR.replace("${key}");
                                     </script>

                                 </td>
                                </tr>
                            % elif key == 'solve':
                                <tr>
                                 <td> ${all_f[key]}</td>
                                 <td>
                                     <textarea disabled name="${key}">
                                         ${obj.__dict__[key]}
                                     </textarea>
                                     <script>
                                     // Replace the <textarea id="editor1"> with a CKEditor
                                     // instance, using default configuration.
                                     CKEDITOR.replace("${key}");
                                     </script>
                                 </td>
                                </tr>
                            % else:
                                <tr>
                                 <td> ${all_f[key]}</td>
                                 <td> ${obj.__dict__[key]}</td>
                                </tr>
                            % endif
                        % endfor
                    % else:
                        % for key in view_f:
                          <tr>
                              <td>${all_f[key]}</td>
                              <td>
                                 %if key == 'dirs':
                                    INBOX, SENT
                                 % elif key == 'disabled':
                                    ${obj.STATUS[obj.__dict__[key]]}
                                 % elif key == 'access_groups':
                                    % for group in obj.__dict__[key]:
                                        ${obj.ACCESS_GROUPS[group]}<br>
                                    % endfor
                                 % else:
                                    ${obj.__dict__[key]}
                                 % endif
                              </td>
                          </tr>
                        % endfor
                    % endif
                %else:
                    <div class="alert alert-warning" role="alert">
                        <p>Недостаточно прав.</p>
                    </div>
                % endif

                	 <tr>
                	 <td><a href="${session_context['back_ref']}">Назад</a></td>
                	 <td><a href="edit">Редактировать</a></td>
                     <td>
                         % if ('admin' in session_context['groups'] or 'expert' in session_context['groups']) and \
                            obj.__tablename__ == 'dynamic_object':
                         <a href="/cases/add?uuid=${obj.uuid}">Создать кейс</a>
                         % endif
                     </td>
                    </tr>
              </tbody>
            </table>
        </div>

    </div>

